<app-custom-layout padding="0" *ngIf="player">

  <div id="description" class="banner">
    <app-player-card [player]="player" detail=true>
      <div *ngIf="user && !player.userId">
        <mat-divider></mat-divider>
        <div>
          <button mat-button color="accent" (click)="doAction('sync')">
            <mat-icon>sync</mat-icon> Récupérer les parties de ce joueur
          </button>
          <p class="help">L'action sera validé dans quelques temps.</p>
        </div>
      </div>
    </app-player-card>
  </div>

  <mat-divider></mat-divider>

  <div id="stats">
    <h3>Statistiques</h3>
    <ng-container *ngIf="plays$ | async as plays; else loading">
      <ng-container *ngIf="plays.length !== 0; else noPlays">
        <div class="charts">
          <app-player-chart [player]="player" [plays]="plays" type="player"></app-player-chart>
          <app-player-chart [player]="player" [plays]="plays" type="playerCount"></app-player-chart>
          <app-player-chart [player]="player" [plays]="plays" type="time"></app-player-chart>
          <div class="inline"></div>
        </div>
        <app-player-table [player]="player" [plays]="plays"></app-player-table>
      </ng-container>
    </ng-container>
  </div>

  <mat-divider></mat-divider>

  <div id="library" *ngIf="player.userId">
    <app-player-library [player]="player"></app-player-library>
  </div>

  <mat-divider></mat-divider>

  <div id="plays" *ngIf="lastPlays$ | async as lastPlays; else loading">
    <div class="title-n-btn">
      <h3>Dernières Parties</h3>
      <a mat-button color="accent" (click)="goPlays()">Tout voir</a>
    </div>
    <app-play-list [plays]="lastPlays"></app-play-list>
  </div>

  <app-layout-side>
    <app-page-shortcut>
      <a mat-button class="active" color="primary" appScrollTo="description">Description</a>
      <a mat-button color="primary" appScrollTo="stats">Statistiques</a>
      <a mat-button color="primary" appScrollTo="library">Ludothèque</a>
      <a mat-button color="primary" appScrollTo="plays">Dernières Parties</a>
    </app-page-shortcut>
  </app-layout-side>

</app-custom-layout>

<ng-template #loading>
  <app-spinner></app-spinner>
</ng-template>

<ng-template #noPlays>
  <mat-grid-list cols="1" rowHeight="4:1">
    <mat-grid-tile>
      <p>Aucune partie pour l'instant. Vous pouvez ajouter une partie.</p>
    </mat-grid-tile>
  </mat-grid-list>
</ng-template>
